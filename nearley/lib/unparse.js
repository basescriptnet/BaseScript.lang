(function(n,r){"object"===typeof module&&module.exports?module.exports=r(require("./nearley.js")):n.Unparser=r(n.nearley)})(this,function(n){function r(g,d){var l="";for(d=[d];0<d.length;){var h=d.pop();if("string"===typeof h){var e=g.rules.filter(function(m){return m.name===h});if(0<e.length){e=e[Math.floor(Math.random()*e.length)];for(var c=e.symbols.length-1;0<=c;c--)d.push(e.symbols[c])}else throw Error("Nothing matches rule: "+h+"!");}else h.test?(e=(new v(h)).gen(),l+=e):h.literal&&(l+=
h.literal)}return l}function x(g,d,l){function h(k,p){for(var b=[],f=Infinity,a=0;a<c.length;a++){m=[];var q=e(a,[]);c[a].name===k&&(f=Math.min(f,q),q<p&&b.push(a))}if(0===b.length)throw"No strings in your grammar have depth "+p+" (and none are shallower). Try increasing -d to at least "+(f+1)+".";k=b[Math.floor(Math.random()*b.length)];b="";for(f=0;f<c[k].symbols.length;f++)a=c[k].symbols[f],"string"===typeof a?b+=h(a,p-1):a.test?b+=(new v(a)).gen():a.literal&&(b+=a.literal);return b}function e(k,
p){if(void 0!==m[k])return m[k];for(var b=1,f=0;f<c[k].symbols.length;f++){var a=c[k].symbols[f];if("string"===typeof a){var q=Math,y=q.max;var w=p;if(-1!==w.indexOf(a))a=Infinity;else{for(var u=Infinity,t=0;t<c.length;t++)c[t].name===a&&(u=Math.min(u,e(t,[a].concat(w))));a=u}b=y.call(q,b,1+a)}}return m[k]=b}var c=g.rules,m=[];return h(d,l)}var v=require("randexp");return function(g,d,l){g=g instanceof n.Grammar?g:n.Grammar.fromCompiled(g,d);return null!=l&&0<l?x(g,d,l):r(g,d)}});
